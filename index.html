<!DOCTYPE html>
<html lang="zh">

<head>
    <meta charset="UTF-8" />
    <title>HSK1 Quiz</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style>
        :root {
            --primary: #3498db;
            --primary-dark: #2980b9;
            --ok: #2ecc71;
            --bad: #e74c3c;
            --text: #2c3e50;
            --accent: #d35400;
        }

        * {
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            text-align: center;
            background: #f7f7f7;
            margin: 0;
            color: var(--text);
        }

        .card {
            background: #fff;
            margin: 30px auto;
            padding: 20px;
            width: 100%;
            max-width: 600px;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15);
            transition: width .3s ease;
        }

        @media (min-width: 720px) {
            .card {
                width: 70%;
            }
        }

        h1 {
            color: var(--accent);
            margin: 8px 0 16px;
        }

        h2 {
            margin: 8px 0 12px;
        }

        .view {
            display: none;
        }

        .view.active {
            display: block;
        }

        .question {
            font-size: 36px;
            margin: 18px 0;
        }

        .btn {
            margin-top: 12px;
            padding: 10px 18px;
            font-size: 18px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            background: var(--primary);
            color: #fff;
            transition: .25s;
        }

        .btn:hover {
            background: var(--primary-dark);
        }

        .btn.secondary {
            background: #95a5a6;
        }

        .btn.secondary:hover {
            background: #7f8c8d;
        }

        .options button {
            display: block;
            width: 100%;
            margin: 10px 0;
            padding: 12px;
            font-size: 18px;
            border-radius: 8px;
            border: 1px solid #ddd;
            cursor: pointer;
            background: #ecf0f1;
            transition: .25s;
        }

        .options button:hover {
            background: #e3e7ea;
        }

        .options button.correct {
            background: var(--ok) !important;
            color: #fff;
            transform: scale(1.03);
        }

        .options button.wrong {
            background: var(--bad) !important;
            color: #fff;
            transform: scale(1.03);
        }

        #result {
            font-size: 20px;
            font-weight: bold;
            margin: 12px 0;
            min-height: 28px;
        }

        #result.correctText {
            color: #27ae60;
            animation: pulse .5s;
        }

        #result.wrongText {
            color: #c0392b;
            animation: shake .5s;
        }

        @keyframes pulse {
            0% {
                transform: scale(1)
            }

            50% {
                transform: scale(1.18)
            }

            100% {
                transform: scale(1)
            }
        }

        @keyframes shake {

            0%,
            100% {
                transform: translateX(0)
            }

            25% {
                transform: translateX(-8px)
            }

            75% {
                transform: translateX(8px)
            }
        }

        input[type="text"],
        input[type="search"] {
            padding: 10px;
            font-size: 18px;
            border-radius: 8px;
            border: 1px solid #ccc;
            width: 80%;
            margin-top: 10px;
        }

        .celebration {
            font-size: 24px;
            font-weight: bold;
            color: #e67e22;
            animation: pulse 1s infinite;
        }

        .muted {
            color: #657786;
        }

        .stats {
            margin-top: 8px;
        }
    </style>
</head>

<body>
    <div class="card">
        <h1>HSK1 Quiz</h1>

        <!-- View: Nh·∫≠p t√™n -->
        <div id="startScreen" class="view active">
            <p>Nh·∫≠p t√™n c·ªßa b·∫°n ƒë·ªÉ b·∫Øt ƒë·∫ßu:</p>
            <input type="text" id="studentName" placeholder="Nh·∫≠p t√™n c·ªßa b·∫°n..." />
            <br />
            <button class="btn" id="startBtn" onclick="startApp()">B·∫Øt ƒë·∫ßu</button>
        </div>

        <!-- View: Menu ch·ªçn b√†i -->
        <div id="menu" class="view">
            <h2 id="welcome"></h2>
            <p class="muted">Ch·ªçn b√†i t·∫≠p:</p>
            <button class="btn" id="btnLesson1" onclick="startLesson(1)">B√†i 1: Tr·∫Øc nghi·ªám ch·ªçn ƒë√°p √°n</button>
            <button class="btn" id="btnLesson2" onclick="startLesson(2)">B√†i 2: Nh·∫≠p c√¢u tr·∫£ l·ªùi</button>
        </div>

        <!-- View: L√†m b√†i -->
        <div id="quizView" class="view">
            <h2 id="lessonTitle"></h2>
            <div class="question" id="question"></div>
            <div class="options" id="options"></div>
            <div id="inputArea" style="display:none;">
                <input type="text" id="inputAnswer" class="input-answer" placeholder="Nh·∫≠p ƒë√°p √°n..." />
                <br />
                <button class="btn" id="checkBtn">Ki·ªÉm tra</button>
            </div>
            <p id="result"></p>
            <button class="btn" id="nextBtn">C√¢u ti·∫øp theo</button>
            <div class="stats muted" id="progress"></div>
        </div>

        <!-- View: K·∫øt qu·∫£ t·ª´ng b√†i -->
        <div id="lessonResultView" class="view">
            <h2 id="lessonResultTitle"></h2>
            <p>C√¢u ƒë√∫ng: <b id="lessonCorrect"></b></p>
            <p>C√¢u sai: <b id="lessonWrong"></b></p>
            <p>T·ªïng s·ªë c√¢u: <b id="lessonTotal"></b></p>
            <div id="nextActions"></div>
        </div>

        <!-- View: K·∫øt qu·∫£ cu·ªëi c√πng -->
        <div id="finalView" class="view">
            <h2 class="celebration" id="finalCongrats"></h2>
            <p>B·∫°n ƒë√£ ho√†n th√†nh T·∫§T C·∫¢ b√†i t·∫≠p</p>
            <p><b>T·ªïng c√¢u ƒë√∫ng:</b> <b id="totalCorrect"></b></p>
            <p><b>T·ªïng c√¢u sai:</b> <b id="totalWrong"></b></p>
            <p><b>T·ªïng s·ªë c√¢u:</b> <b id="totalQuestions"></b></p>
            <button class="btn" id="restartBtn">L√†m l·∫°i t·ª´ ƒë·∫ßu</button>
        </div>
    </div>

    <script>
        // ================== D·ªÆ LI·ªÜU ==================
        const lesson1 = [{ hanzi: "‰Ω†", options: ["t√¥i", "b·∫°n", "anh ·∫•y"], answer: "b·∫°n" },
        { hanzi: "‰Ω†Â•Ω", options: ["xin ch√†o", "t·∫°m bi·ªát", "c·∫£m ∆°n"], answer: "xin ch√†o" },
        { hanzi: "Êàë", options: ["t√¥i", "ch√∫ng ta", "h·ªç"], answer: "t√¥i" },
        { hanzi: "Ëã±ÂõΩ", options: ["Nh·∫≠t B·∫£n", "Vi·ªát Nam", "Trung Qu·ªëc", "M·ªπ", "H√†n Qu·ªëc", "Anh Qu·ªëc"], answer: "Anh Qu·ªëc" },
        { hanzi: "ÊúãÂèã", options: ["b·∫°n b√®", "h·ªçc sinh", "b·∫°n h·ªçc"], answer: "b·∫°n b√®" },
        { hanzi: "ÂÜçËßÅ", options: ["xin ch√†o", "t·∫°m bi·ªát", "c·∫£m ∆°n"], answer: "t·∫°m bi·ªát" },
        { hanzi: "‰∏≠ÂõΩ", options: ["Nh·∫≠t B·∫£n", "Vi·ªát Nam", "Trung Qu·ªëc", "M·ªπ", "H√†n Qu·ªëc", "Anh Qu·ªëc"], answer: "Trung Qu·ªëc" },
        { hanzi: "‰ªäÂπ¥", options: ["nƒÉm ngo√°i", "nƒÉm nay", "nƒÉm sau"], answer: "nƒÉm nay" },
        { hanzi: "Ë∞¢Ë∞¢", options: ["c·∫£m ∆°n", "xin l·ªói", "ch√†o"], answer: "c·∫£m ∆°n" },
        { hanzi: "Â•Ω", options: ["ngon", "t·ªët", "x·∫•u"], answer: "t·ªët" },
        { hanzi: "Â≠¶Áîü", options: ["h·ªçc sinh", "c√¥ng nh√¢n", "b√°c sƒ©"], answer: "h·ªçc sinh" },
        { hanzi: "Ë∂äÂçó", options: ["Nh·∫≠t B·∫£n", "Vi·ªát Nam", "Trung Qu·ªëc", "M·ªπ", "H√†n Qu·ªëc", "Anh Qu·ªëc"], answer: "Vi·ªát Nam" },
        { hanzi: "ÂØπ‰∏çËµ∑", options: ["c·∫£m ∆°n", "xin l·ªói", "ch√†o"], answer: "xin l·ªói" },
        { hanzi: "Â•π", options: ["b·∫°n", "t√¥i", "anh ·∫•y", "c√¥ ·∫•y"], answer: "c√¥ ·∫•y" },
        { hanzi: "Êó•Êú¨", options: ["Nh·∫≠t B·∫£n", "Vi·ªát Nam", "Trung Qu·ªëc", "M·ªπ", "H√†n Qu·ªëc", "Anh Qu·ªëc"], answer: "Nh·∫≠t B·∫£n" },
        { hanzi: "‰ªñ", options: ["b·∫°n", "t√¥i", "anh ·∫•y", "c√¥ ·∫•y"], answer: "anh ·∫•y" },
        { hanzi: "ÁæéÂõΩ", options: ["Nh·∫≠t B·∫£n", "Vi·ªát Nam", "Trung Qu·ªëc", "M·ªπ", "H√†n Qu·ªëc", "Anh Qu·ªëc"], answer: "M·ªπ" },
        { hanzi: "ËÄÅÂ∏à", options: ["gi√°o vi√™n", "h·ªçc sinh", "b√°c sƒ©"], answer: "gi√°o vi√™n" },
        { hanzi: "Èü©ÂõΩ", options: ["Nh·∫≠t B·∫£n", "Vi·ªát Nam", "Trung Qu·ªëc", "M·ªπ", "H√†n Qu·ªëc", "Anh Qu·ªëc"], answer: "H√†n Qu·ªëc" },
        { hanzi: "ÂêåÂ≠¶", options: ["b·∫°n b√®", "h·ªçc sinh", "b·∫°n h·ªçc"], answer: "b·∫°n h·ªçc" },];

        const lesson2 = [
            { question: "‰Ω†", answer: "b·∫°n" },
            { question: "t√¥i", answer: "Êàë" },
            { question: "Â•Ω", answer: "t·ªët" },
            { question: "c·∫£m ∆°n", answer: "Ë∞¢Ë∞¢" }
        ];

        // ================== TR·∫†NG TH√ÅI ==================
        let studentName = "";
        let currentLesson = 1;
        let currentIndex = 0;
        let correctCount = 0;
        let wrongCount = 0;

        // L∆∞u k·∫øt qu·∫£ cu·ªëi c·ªßa t·ª´ng b√†i ƒë·ªÉ tr√°nh c·ªông d·ªìn nhi·ªÅu l·∫ßn khi l√†m l·∫°i
        const scores = {
            1: { correct: 0, wrong: 0, total: lesson1.length, done: false },
            2: { correct: 0, wrong: 0, total: lesson2.length, done: false },
        };

        // ================== TI·ªÜN √çCH VIEW ==================
        function showView(id) {
            document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
            document.getElementById(id).classList.add('active');
        }

        // ================== KH·ªûI T·∫†O ==================
        document.getElementById('nextBtn').addEventListener('click', () => nextQuestion());
        document.getElementById('checkBtn').addEventListener('click', () => checkInputAnswer());
        document.getElementById('restartBtn')?.addEventListener('click', () => restartAll());

        // ================== LU·ªíNG CH√çNH ==================

        function startApp() {
            const name = document.getElementById('studentName').value.trim();
            if (!name) return alert('Vui l√≤ng nh·∫≠p t√™n!');
            studentName = name;
            document.getElementById('welcome').innerText = `Ch√†o ${studentName}, ch·ªçn b√†i t·∫≠p ƒë·ªÉ b·∫Øt ƒë·∫ßu!`;
            showView('menu');
        }
        function startLesson(lesson) {
            currentLesson = lesson;
            currentIndex = 0;
            correctCount = 0;
            wrongCount = 0;

            document.getElementById('lessonTitle').innerText = `B√†i ${lesson}`;
            document.getElementById('result').innerText = '';
            document.getElementById('result').className = '';

            // C·∫•u h√¨nh theo b√†i
            const isLesson1 = lesson === 1;
            document.getElementById('options').innerHTML = '';
            document.getElementById('inputArea').style.display = isLesson1 ? 'none' : 'block';
            document.getElementById('nextBtn').style.display = isLesson1 ? 'inline-block' : 'none';
            document.getElementById('progress').innerText = '';
            const input = document.getElementById('inputAnswer');
            input.removeEventListener('keydown', handleEnterKey);
            if (!isLesson1) {
                input.addEventListener('keydown', handleEnterKey);
            }
            loadQuestion();
            showView('quizView');
        }
        function handleEnterKey(event) {
            if (event.key === "Enter") {
                event.preventDefault();
                checkInputAnswer();
            }
        }
        function loadQuestion() {
            const isLesson1 = currentLesson === 1;
            const data = isLesson1 ? lesson1 : lesson2;
            const q = data[currentIndex];

            // Reset v√πng k·∫øt qu·∫£/tu·ª≥ ch·ªçn
            const resultEl = document.getElementById('result');
            resultEl.innerText = '';
            resultEl.className = '';
            document.getElementById('options').innerHTML = '';

            if (isLesson1) {
                document.getElementById('question').innerText = q.hanzi;
                q.options.forEach(opt => {
                    const btn = document.createElement('button');
                    btn.textContent = opt;
                    btn.addEventListener('click', () => checkSelectAnswer(btn, opt));
                    document.getElementById('options').appendChild(btn);
                });
            } else {
                document.getElementById('question').innerText = q.question;
                const input = document.getElementById('inputAnswer');
                input.value = '';
                input.focus();
            }

            // Ti·∫øn ƒë·ªô
            document.getElementById('progress').innerText = `C√¢u ${currentIndex + 1} / ${data.length}`;
        }

        function checkSelectAnswer(btn, choice) {
            const correct = lesson1[currentIndex].answer;
            const result = document.getElementById('result');
            if (choice === correct) {
                btn.classList.add('correct');
                result.innerText = '‚úî ƒê√∫ng r·ªìi!';
                result.className = 'correctText';
                correctCount++;
            } else {
                btn.classList.add('wrong');
                result.innerText = '‚úò Sai, ƒë√°p √°n ƒë√∫ng: ' + correct;
                result.className = 'wrongText';
                wrongCount++;
            }
            // Kho√° c√°c l·ª±a ch·ªçn
            document.querySelectorAll('#options button').forEach(b => b.disabled = true);
        }

        function checkInputAnswer() {
            const userAns = document.getElementById('inputAnswer').value.trim();
            const correct = lesson2[currentIndex].answer;
            const result = document.getElementById('result');
            if (userAns === correct) {
                result.innerText = '‚úî ƒê√∫ng r·ªìi!';
                result.className = 'correctText';
                correctCount++;
            } else {
                result.innerText = `‚úò Sai, ƒë√°p √°n ƒë√∫ng: ${correct}`;
                result.className = 'wrongText';
                wrongCount++;
            }
            // T·ª± chuy·ªÉn c√¢u sau 900ms
            setTimeout(nextQuestion, 900);
        }

        function nextQuestion() {
            const isLesson1 = currentLesson === 1;
            const totalQ = isLesson1 ? lesson1.length : lesson2.length;

            currentIndex++;

            if (currentIndex >= totalQ) {
                // L∆∞u ƒëi·ªÉm cho b√†i hi·ªán t·∫°i (ghi ƒë√® l·∫ßn l√†m m·ªõi)
                scores[currentLesson].correct = correctCount;
                scores[currentLesson].wrong = wrongCount;
                scores[currentLesson].done = true;

                // Hi·ªÉn th·ªã k·∫øt qu·∫£ b√†i hi·ªán t·∫°i
                showLessonResult();

                // N·∫øu c·∫£ 2 b√†i ƒë·ªÅu xong, c≈©ng chu·∫©n b·ªã s·∫µn final stats
                if (scores[1].done && scores[2].done) {
                    updateFinalStats();
                }
            } else {
                loadQuestion();
            }
        }

        function showLessonResult() {
            const s = scores[currentLesson];
            document.getElementById('lessonResultTitle').innerText = `Ho√†n th√†nh B√†i ${currentLesson}!`;
            document.getElementById('lessonCorrect').innerText = s.correct;
            document.getElementById('lessonWrong').innerText = s.wrong;
            document.getElementById('lessonTotal').innerText = s.total;

            const nextActions = document.getElementById('nextActions');
            nextActions.innerHTML = '';


            // G·ª£i √Ω b√†i ch∆∞a l√†m
            const other = currentLesson === 1 ? 2 : 1;


            if (!scores[other].done) {
                const goOther = document.createElement('button');
                goOther.className = 'btn';
                goOther.style.marginLeft = '8px';
                goOther.textContent = `L√†m ti·∫øp B√†i ${other}`;
                goOther.addEventListener('click', () => startLesson(other));
                nextActions.appendChild(goOther);
            } else {
                // N·∫øu c·∫£ hai ƒë√£ xong, g·ª£i √Ω xem t·ªïng k·∫øt

                const restartBtn = document.createElement('button');
                restartBtn.className = 'btn';
                restartBtn.id = "restartBtn";
                restartBtn.textContent = 'L√†m l·∫°i t·ª´ ƒë·∫ßu';
                nextActions.appendChild(restartBtn);
                const finalBtn = document.createElement('button');
                finalBtn.className = 'btn';
                finalBtn.style.marginLeft = '8px';
                finalBtn.textContent = 'Xem th·ªëng k√™ t·ªïng';
                finalBtn.addEventListener('click', () => {
                    updateFinalStats();
                    showView('finalView');
                });
                nextActions.appendChild(finalBtn);
            }

            showView('lessonResultView');
        }

        function updateFinalStats() {
            const totalCorrect = scores[1].correct + scores[2].correct;
            const totalWrong = scores[1].wrong + scores[2].wrong;
            const totalQ = scores[1].total + scores[2].total;

            document.getElementById('finalCongrats').innerText = `üéâ Ch√∫c m·ª´ng, ${studentName}! üéâ`;
            document.getElementById('totalCorrect').innerText = totalCorrect;
            document.getElementById('totalWrong').innerText = totalWrong;
            document.getElementById('totalQuestions').innerText = totalQ;
        }

        function restartAll() {
            // Reset to√†n b·ªô
            scores[1] = { correct: 0, wrong: 0, total: lesson1.length, done: false };
            scores[2] = { correct: 0, wrong: 0, total: lesson2.length, done: false };
            currentIndex = 0; correctCount = 0; wrongCount = 0; currentLesson = 1;
            showView('menu');
        }
    </script>
</body>

</html>
